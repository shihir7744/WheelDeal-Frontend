<div class="booking-container">
  <div class="container py-4">
    <!-- Header -->
    <div class="booking-header text-center mb-5 fade-in">
      <h1 class="display-5 fw-bold text-white mb-3">My Bookings</h1>
      <p class="lead text-white-50">Manage your car rental bookings</p>
    </div>

    <!-- Booking Stats -->
    <div class="row mb-4">
      <div class="col-md-3 col-6 mb-3" *ngFor="let stat of bookingStats; let i = index">
        <div class="stat-card card text-center bounce-in" [style.animation-delay]="(i * 0.1) + 's'">
          <div class="card-body p-3">
            <div class="stat-icon mb-2">
              <i [class]="stat.icon"></i>
            </div>
            <h4 class="stat-number mb-1">{{ stat.count }}</h4>
            <p class="stat-label mb-0">{{ stat.label }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter Tabs -->
    <div class="filter-tabs mb-4 slide-up">
      <ul class="nav nav-pills justify-content-center">
        <li class="nav-item" *ngFor="let filter of statusFilters">
          <button 
            class="nav-link"
            [class.active]="currentFilter === filter.value"
            (click)="setFilter(filter.value)"
          >
            <i [class]="filter.icon + ' me-2'"></i>
            {{ filter.label }}
            <span class="badge bg-light text-dark ms-2">{{ getFilterCount(filter.value) }}</span>
          </button>
        </li>
      </ul>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="text-center py-5">
      <div class="spinner"></div>
      <p class="text-white mt-3">Loading bookings...</p>
    </div>

    <!-- No Bookings -->
    <div *ngIf="!isLoading && filteredBookings.length === 0" class="no-bookings text-center py-5">
      <div class="no-bookings-icon mb-3">
        <i class="fas fa-calendar-times fa-4x text-white-50"></i>
      </div>
      <h4 class="text-white">No bookings found</h4>
      <p class="text-white-50 mb-4">You haven't made any bookings yet</p>
      <button class="btn btn-primary btn-lg" routerLink="/cars">
        <i class="fas fa-search me-2"></i>
        Browse Cars
      </button>
    </div>

    <!-- Bookings List -->
    <div *ngIf="!isLoading && filteredBookings.length > 0" class="bookings-list">
      <div 
        *ngFor="let booking of filteredBookings; let i = index" 
        class="booking-card card mb-4 slide-up"
        [style.animation-delay]="(i * 0.1) + 's'"
      >
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-md-2">
              <div class="car-thumbnail">
                <img [src]="getCarImage(booking)" [alt]="booking.carBrand + ' ' + booking.carModel" class="img-fluid rounded">
              </div>
            </div>
            
            <div class="col-md-6">
              <div class="booking-details">
                <h5 class="fw-bold mb-2">{{ booking.carBrand }} {{ booking.carModel }}</h5>
                <p class="text-muted mb-1">
                  <i class="fas fa-car me-2"></i>{{ booking.carType }}
                </p>
                <p class="text-muted mb-1">
                  <i class="fas fa-calendar me-2"></i>
                  {{ formatDate(booking.startDate) }} - {{ formatDate(booking.endDate) }}
                </p>
                <p class="text-muted mb-0">
                  <i class="fas fa-clock me-2"></i>
                  Booked on {{ formatDate(booking.createdAt) }}
                </p>
                <small class="text-warning d-block mt-2" *ngIf="isPending(booking)">Pending approval</small>
                <small class="text-info d-block mt-1" *ngIf="isConfirmed(booking)">Confirmed, not yet active</small>
              </div>
            </div>
            
            <div class="col-md-2 text-center">
              <div class="booking-duration mb-2">
                <span class="duration-number">{{ calculateDuration(booking.startDate, booking.endDate) }}</span>
                <span class="duration-label">days</span>
              </div>
            </div>
            
            <div class="col-md-2 text-end">
              <div class="booking-status mb-3">
                <span class="badge" [ngClass]="getStatusBadgeClass(booking.status)">
                  {{ booking.status }}
                </span>
              </div>
              
              <div class="booking-actions">
                <button 
                  class="btn btn-outline-primary btn-sm me-2"
                  (click)="viewBookingDetails(booking)"
                >
                  <i class="fas fa-eye"></i>
                </button>
                
                <button 
                  *ngIf="canCancelBooking(booking)"
                  class="btn btn-outline-danger btn-sm"
                  (click)="cancelBooking(booking)"
                  [disabled]="isCancelling"
                >
                  <i class="fas fa-times" *ngIf="!isCancelling"></i>
                  <span *ngIf="isCancelling" class="spinner-border spinner-border-sm"></span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Booking Details Modal -->
<div class="modal fade" id="bookingDetailsModal" tabindex="-1" *ngIf="selectedBooking">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <i class="fas fa-calendar-alt me-2"></i>
          Booking Details
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-md-4">
            <img [src]="getCarImage(selectedBooking)" [alt]="selectedBooking.carBrand + ' ' + selectedBooking.carModel" class="img-fluid rounded mb-3">
          </div>
          <div class="col-md-8">
            <h4 class="fw-bold mb-3">{{ selectedBooking.carBrand }} {{ selectedBooking.carModel }}</h4>
            
            <div class="booking-info">
              <div class="info-row mb-2">
                <strong>Booking ID:</strong>
                <span class="ms-2">#{{ selectedBooking.id }}</span>
              </div>
              
              <div class="info-row mb-2">
                <strong>Car Type:</strong>
                <span class="ms-2">{{ selectedBooking.carType }}</span>
              </div>
              
              <div class="info-row mb-2">
                <strong>Rental Period:</strong>
                <span class="ms-2">{{ formatDate(selectedBooking.startDate) }} - {{ formatDate(selectedBooking.endDate) }}</span>
              </div>
              
              <div class="info-row mb-2">
                <strong>Duration:</strong>
                <span class="ms-2">{{ calculateDuration(selectedBooking.startDate, selectedBooking.endDate) }} days</span>
              </div>
              
              <div class="info-row mb-2">
                <strong>Status:</strong>
                <span class="badge ms-2" [ngClass]="getStatusBadgeClass(selectedBooking.status)">{{ selectedBooking.status }}</span>
              </div>
              
              <div class="info-row mb-2">
                <strong>Booked On:</strong>
                <span class="ms-2">{{ formatDate(selectedBooking.createdAt) }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button 
          *ngIf="canCancelBooking(selectedBooking)"
          type="button" 
          class="btn btn-danger"
          (click)="cancelBooking(selectedBooking)"
          [disabled]="isCancelling"
        >
          <span *ngIf="isCancelling" class="spinner-border spinner-border-sm me-2"></span>
          <i *ngIf="!isCancelling" class="fas fa-times me-2"></i>
          {{ isCancelling ? 'Cancelling...' : 'Cancel Booking' }}
        </button>
      </div>
    </div>
  </div>
</div>


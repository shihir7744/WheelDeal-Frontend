import{b,c as x}from"./chunk-VKRG3NZS.js";import{$b as N,Ea as v,Ha as c,Ib as y,Lb as C,Oa as d,Sa as r,Ta as i,Ua as w,Wa as P,Xa as h,Xb as S,Zb as F,_b as M,ac as E,bc as I,cb as s,db as _,hb as p,ib as f,jb as u,kc as W,mc as T,va as o,za as g}from"./chunk-N4QFKIMT.js";function q(a,n){if(a&1&&(r(0,"div",21),s(1),i()),a&2){let l=h();o(),_(l.error)}}function L(a,n){if(a&1&&(r(0,"div",22),s(1),i()),a&2){let l=h();o(),_(l.success)}}function B(a,n){a&1&&w(0,"span",23)}function O(a,n){a&1&&w(0,"span",23)}var U=class a{constructor(n,l){this.auth=n;this.users=l}user=null;isLoading=!1;error=null;success=null;profileForm={fullName:"",email:""};passwordForm={currentPassword:"",newPassword:"",confirmPassword:""};savingProfile=!1;changingPassword=!1;ngOnInit(){let n=this.auth.getCurrentUser();this.user=n,n&&(this.profileForm.fullName=n.fullName||"",this.profileForm.email=n.email||"")}saveProfile(){if(this.user){if(!this.profileForm.fullName||!this.profileForm.email){this.error="Full name and email are required";return}this.savingProfile=!0,this.error=null,this.success=null,this.users.updateUser(this.user.id,{fullName:this.profileForm.fullName,email:this.profileForm.email}).subscribe({next:n=>{this.success="Profile updated successfully",this.savingProfile=!1},error:n=>{console.error(n),this.error="Failed to update profile",this.savingProfile=!1}})}}changePassword(){if(this.user){if(!this.passwordForm.newPassword||this.passwordForm.newPassword.length<6){this.error="New password must be at least 6 characters";return}if(this.passwordForm.newPassword!==this.passwordForm.confirmPassword){this.error="Passwords do not match";return}this.changingPassword=!0,this.error=null,this.success=null,setTimeout(()=>{this.success="Password change requested. Please contact support or admin to update password.",this.changingPassword=!1,this.passwordForm={currentPassword:"",newPassword:"",confirmPassword:""}},600)}}static \u0275fac=function(l){return new(l||a)(g(b),g(x))};static \u0275cmp=v({type:a,selectors:[["app-profile"]],decls:45,vars:11,consts:[[1,"container","py-4"],[1,"mb-4"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[1,"card","mb-4"],[1,"card-header"],[1,"card-body"],[1,"row","g-3",3,"ngSubmit"],[1,"col-md-6"],[1,"form-label"],["type","text","name","fullName","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","email","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],[1,"card"],[1,"col-md-4"],["type","password","name","currentPassword",1,"form-control",3,"ngModelChange","ngModel"],["type","password","name","newPassword","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","password","name","confirmPassword","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-outline-primary",3,"disabled"],[1,"alert","alert-danger"],[1,"alert","alert-success"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(l,e){l&1&&(r(0,"div",0)(1,"h2",1),s(2,"My Profile"),i(),c(3,q,2,1,"div",2)(4,L,2,1,"div",3),r(5,"div",4)(6,"div",5)(7,"strong"),s(8,"Profile Information"),i()(),r(9,"div",6)(10,"form",7),P("ngSubmit",function(){return e.saveProfile()}),r(11,"div",8)(12,"label",9),s(13,"Full Name"),i(),r(14,"input",10),u("ngModelChange",function(t){return f(e.profileForm.fullName,t)||(e.profileForm.fullName=t),t}),i()(),r(15,"div",8)(16,"label",9),s(17,"Email"),i(),r(18,"input",11),u("ngModelChange",function(t){return f(e.profileForm.email,t)||(e.profileForm.email=t),t}),i()(),r(19,"div",12)(20,"button",13),c(21,B,1,0,"span",14),s(22," Save Changes "),i()()()()(),r(23,"div",15)(24,"div",5)(25,"strong"),s(26,"Change Password"),i()(),r(27,"div",6)(28,"form",7),P("ngSubmit",function(){return e.changePassword()}),r(29,"div",16)(30,"label",9),s(31,"Current Password"),i(),r(32,"input",17),u("ngModelChange",function(t){return f(e.passwordForm.currentPassword,t)||(e.passwordForm.currentPassword=t),t}),i()(),r(33,"div",16)(34,"label",9),s(35,"New Password"),i(),r(36,"input",18),u("ngModelChange",function(t){return f(e.passwordForm.newPassword,t)||(e.passwordForm.newPassword=t),t}),i()(),r(37,"div",16)(38,"label",9),s(39,"Confirm Password"),i(),r(40,"input",19),u("ngModelChange",function(t){return f(e.passwordForm.confirmPassword,t)||(e.passwordForm.confirmPassword=t),t}),i()(),r(41,"div",12)(42,"button",20),c(43,O,1,0,"span",14),s(44," Update Password "),i()()()()()()),l&2&&(o(3),d("ngIf",e.error),o(),d("ngIf",e.success),o(10),p("ngModel",e.profileForm.fullName),o(4),p("ngModel",e.profileForm.email),o(2),d("disabled",e.savingProfile),o(),d("ngIf",e.savingProfile),o(11),p("ngModel",e.passwordForm.currentPassword),o(4),p("ngModel",e.passwordForm.newPassword),o(4),p("ngModel",e.passwordForm.confirmPassword),o(2),d("disabled",e.changingPassword),o(),d("ngIf",e.changingPassword))},dependencies:[C,y,T,I,S,F,M,W,E,N],styles:[".container[_ngcontent-%COMP%]{max-width:900px}.card-header[_ngcontent-%COMP%]{background:#fff9;-webkit-backdrop-filter:blur(6px);backdrop-filter:blur(6px)}"]})};export{U as ProfileComponent};
